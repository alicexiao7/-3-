# Лабораторная работа: Управление тарифами АТС

## Описание проекта

Приложение реализует управление тарифами АТС с графическим интерфейсом на C++/CLI и использованием DataGridView. В качестве базы данных используется CSV-файл (имитация БД). Программа позволяет:

- Добавлять, редактировать и удалять тарифы.
- Сохранять данные в CSV-файл и загружать их из него.
- Сортировать тарифы по имени и цене.
- Проверять корректность введённых данных (цена > 0, скидка 0–100%).
- Обрабатывать ошибки ввода в DataGridView.

---

## Структура проекта

| Файл | Описание |
|------|----------|
| MainForm.h/cpp | Главное окно с таблицей тарифов и кнопками управления. |
| AddEditForm.h/cpp | Окно для добавления и редактирования тарифа. |
| ATC.h/cpp | Класс модели ATC, управляющий списком тарифов, сохранением и загрузкой CSV. |
| Tariff.h/cpp | Класс модели Tariff, описывающий один тариф (название, цена, скидка). |
| Programm.cpp | Точка входа в программу (main функция). |

---

## Основные классы

### Tariff
- Name — название тарифа.
- Price — стоимость тарифа (>0).
- Discount — скидка (0–100%).
- CalculateCost() — вычисление цены с учётом скидки.

### ATC
- Add(Tariff^) — добавление тарифа.
- Remove(int) — удаление тарифа по индексу.
- GetAll() — получение списка всех тарифов.
- SortByName(), SortByPrice() — сортировка тарифов.
- SaveCSV(String^), LoadCSV(String^) — работа с CSV.

### MainForm
- Отображение всех тарифов через DataGridView.
- Кнопки управления: Add, Remove, Save CSV, Load CSV, Sort Name, Sort Price.
- Обработка ошибок ввода через событие DataError.

### AddEditForm
- Поля для ввода имени, цены и скидки.
- Валидация данных: цена > 0, скидка 0–100.
- Конструктор перегружен для редактирования существующих тарифов.

---

## Использование

1. Запуск программы: запустить Programm.exe (или через Visual Studio).
2. Добавление тарифа: нажмите Add, заполните поля и подтвердите OK.
3. Редактирование тарифа: дважды щелкните на строке в таблице.
4. Удаление тарифа: выделите строку и нажмите Remove.
5. Сортировка: используйте кнопки Sort Name и Sort Price.
6. Сохранение/Загрузка: данные сохраняются и загружаются из файла data.csv. Автосохранение также реализовано.

---

## Особенности реализации

- Используется CSV как имитация базы данных.
- Валидация полей предотвращает ошибки при вводе некорректных данных.
- Обработчик DataGridView.DataError предотвращает вылет программы при некорректных данных.
- Автосохранение: данные сохраняются автоматически при изменении таблицы.

---

## Требования

- Visual Studio с поддержкой C++/CLI.
- .NET Framework (4.7+ рекомендуется).

---

## Сборка проекта

1. Откройте .sln проект в Visual Studio.
2. Соберите решение (Build -> Build Solution).
3. Запустите приложение (Debug -> Start Debugging).

---

## Дальнейшие улучшения

- Подключение реальной базы данных (SQLite, MySQL) вместо CSV.
- Добавление поиска по тарифам.
- Улучшение интерфейса с использованием TabControl или Panel для управления окнами.
